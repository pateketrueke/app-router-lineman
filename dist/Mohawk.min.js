/*! Mohawk - v0.3.1 - 2013-08-16 */
(function(e){"use strict";function t(e){this.string=e}function n(e){this.name=e}function r(e){this.name=e}function i(){}function o(e,o,a){"/"===e.charAt(0)&&(e=e.substr(1));for(var s=e.split("/"),u=[],c=0,l=s.length;l>c;c++){var h,f=s[c];(h=f.match(/^:([^\/]+)$/))?(u.push(new n(h[1])),o.push(h[1]),a.dynamics++):(h=f.match(/^\*([^\/]+)$/))?(u.push(new r(h[1])),o.push(h[1]),a.stars++):""===f?u.push(new i):(u.push(new t(f)),a.statics++)}return u}function a(e){this.charSpec=e,this.nextStates=[]}function s(e){return e.sort(function(e,t){return e.types.stars!==t.types.stars?e.types.stars-t.types.stars:e.types.dynamics!==t.types.dynamics?e.types.dynamics-t.types.dynamics:e.types.statics!==t.types.statics?e.types.statics-t.types.statics:0})}function u(e,t){for(var n=[],r=0,i=e.length;i>r;r++){var o=e[r];n=n.concat(o.match(t))}return n}function c(e,t){for(var n=e.handlers,r=e.regex,i=t.match(r),o=1,a=[],s=0,u=n.length;u>s;s++){for(var c=n[s],l=c.names,h={},f=0,d=l.length;d>f;f++)h[l[f]]=i[o++];a.push({handler:c.handler,params:h,isDynamic:!!l.length})}return a}function l(e,t){return t.eachChar(function(t){e=e.put(t)}),e}function h(e,t,n){this.path=e,this.matcher=t,this.delegate=n}function f(e){this.routes={},this.children={},this.target=e}function d(e,t,n){return function(r,i){var o=e+r;return i?(i(d(o,t,n)),void 0):new h(e+r,t,n)}}function p(e,t,n){for(var r=0,i=0,o=e.length;o>i;i++)r+=e[i].path.length;t=t.substr(r),e.push({path:t,handler:n})}function v(e,t,n,r){var i=t.routes;for(var o in i)if(i.hasOwnProperty(o)){var a=e.slice();p(a,o,i[o]),t.children[o]?v(a,t.children[o],n,r):n.call(r,a)}}var g=["/",".","*","+","?","|","(",")","[","]","{","}","\\"],m=RegExp("(\\"+g.join("|\\")+")","g");t.prototype={eachChar:function(e){for(var t,n=this.string,r=0,i=n.length;i>r;r++)t=n.charAt(r),e({validChars:t})},regex:function(){return this.string.replace(m,"\\$1")},generate:function(){return this.string}},n.prototype={eachChar:function(e){e({invalidChars:"/",repeat:!0})},regex:function(){return"([^/]+)"},generate:function(e){return e[this.name]}},r.prototype={eachChar:function(e){e({invalidChars:"",repeat:!0})},regex:function(){return"(.+)"},generate:function(e){return e[this.name]}},i.prototype={eachChar:function(){},regex:function(){return""},generate:function(){return""}},a.prototype={get:function(e){for(var t=this.nextStates,n=0,r=t.length;r>n;n++){var i=t[n],o=i.charSpec.validChars===e.validChars;if(o=o&&i.charSpec.invalidChars===e.invalidChars)return i}},put:function(e){var t;return(t=this.get(e))?t:(t=new a(e),this.nextStates.push(t),e.repeat&&t.nextStates.push(t),t)},match:function(e){for(var t,n,r,i=this.nextStates,o=[],a=0,s=i.length;s>a;a++)t=i[a],n=t.charSpec,(r=n.validChars)!==void 0?-1!==r.indexOf(e)&&o.push(t):(r=n.invalidChars)!==void 0&&-1===r.indexOf(e)&&o.push(t);return o}};var y=function(){this.rootState=new a,this.names={}};y.prototype={add:function(e,t){for(var n,r=this.rootState,a="^",s={statics:0,dynamics:0,stars:0},u=[],c=[],h=!0,f=0,d=e.length;d>f;f++){var p=e[f],v=[],g=o(p.path,v,s);c=c.concat(g);for(var m=0,y=g.length;y>m;m++){var w=g[m];w instanceof i||(h=!1,r=r.put({validChars:"/"}),a+="/",r=l(r,w),a+=w.regex())}u.push({handler:p.handler,names:v})}h&&(r=r.put({validChars:"/"}),a+="/"),r.handlers=u,r.regex=RegExp(a+"$"),r.types=s,(n=t&&t.as)&&(this.names[n]={segments:c,handlers:u})},handlersFor:function(e){var t=this.names[e],n=[];if(!t)throw Error("There is no route named "+e);for(var r=0,i=t.handlers.length;i>r;r++)n.push(t.handlers[r]);return n},hasRoute:function(e){return!!this.names[e]},generate:function(e,t){var n=this.names[e],r="";if(!n)throw Error("There is no route named "+e);for(var o=n.segments,a=0,s=o.length;s>a;a++){var u=o[a];u instanceof i||(r+="/",r+=u.generate(t))}return"/"!==r.charAt(0)&&(r="/"+r),r},recognize:function(e){var t,n,r,i=[this.rootState];for("/"!==e.charAt(0)&&(e="/"+e),t=e.length,t>1&&"/"===e.charAt(t-1)&&(e=e.substr(0,t-1)),n=0,r=e.length;r>n&&(i=u(i,e.charAt(n)),i.length);n++);var o=[];for(n=0,r=i.length;r>n;n++)i[n].handlers&&o.push(i[n]);i=s(o);var a=o[0];return a&&a.handlers?c(a,e):void 0}},h.prototype={to:function(e,t){var n=this.delegate;if(n&&n.willAddRoute&&(e=n.willAddRoute(this.matcher.target,e)),this.matcher.add(this.path,e),t){if(0===t.length)throw Error("You must have an argument in the function passed to `to`");this.matcher.addChild(this.path,e,t,this.delegate)}}},f.prototype={add:function(e,t){this.routes[e]=t},addChild:function(e,t,n,r){var i=new f(t);this.children[e]=i;var o=d(e,i,r);r&&r.contextEntered&&r.contextEntered(t,o),n(o)}},y.prototype.map=function(e,t){var n=new f;e(d("",n,this.delegate)),v([],n,function(e){t?t(this,e):this.add(e)},this)},e.RouteRecognizer=y})(window),function(){var e,t;(function(){var n={},r={};e=function(e,t,r){n[e]={deps:t,callback:r}},t=function(e){if(r[e])return r[e];r[e]={};for(var i,o=n[e],a=o.deps,s=o.callback,u=[],c=0,l=a.length;l>c;c++)"exports"===a[c]?u.push(i={}):u.push(t(a[c]));var h=s.apply(this,u);return r[e]=i||h}})(),e("rsvp/all",["rsvp/defer","exports"],function(e,t){"use strict";function n(e){var t=[],n=r(),i=e.length;0===i&&n.resolve([]);for(var o=function(e){return function(t){a(e,t)}},a=function(e,r){t[e]=r,0===--i&&n.resolve(t)},s=function(e){n.reject(e)},u=0;e.length>u;u++)e[u]&&"function"==typeof e[u].then?e[u].then(o(u),s):a(u,e[u]);return n.promise}var r=e.defer;t.all=n}),e("rsvp/async",["exports"],function(e){"use strict";var t,n="undefined"!=typeof window?window:{},r=n.MutationObserver||n.WebKitMutationObserver;if("undefined"!=typeof process&&"[object process]"==={}.toString.call(process))t=function(e,t){process.nextTick(function(){e.call(t)})};else if(r){var i=[],o=new r(function(){var e=i.slice();i=[],e.forEach(function(e){var t=e[0],n=e[1];t.call(n)})}),a=document.createElement("div");o.observe(a,{attributes:!0}),window.addEventListener("unload",function(){o.disconnect(),o=null}),t=function(e,t){i.push([e,t]),a.setAttribute("drainQueue","drainQueue")}}else t=function(e,t){setTimeout(function(){e.call(t)},1)};e.async=t}),e("rsvp/config",["rsvp/async","exports"],function(e,t){"use strict";var n=e.async,r={};r.async=n,t.config=r}),e("rsvp/defer",["rsvp/promise","exports"],function(e,t){"use strict";function n(){var e={},t=new r(function(t,n){e.resolve=t,e.reject=n});return e.promise=t,e}var r=e.Promise;t.defer=n}),e("rsvp/events",["exports"],function(e){"use strict";var t=function(e,t){this.type=e;for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n])},n=function(e,t){for(var n=0,r=e.length;r>n;n++)if(e[n][0]===t)return n;return-1},r=function(e){var t=e._promiseCallbacks;return t||(t=e._promiseCallbacks={}),t},i={mixin:function(e){return e.on=this.on,e.off=this.off,e.trigger=this.trigger,e},on:function(e,t,i){var o,a,s=r(this);for(e=e.split(/\s+/),i=i||this;a=e.shift();)o=s[a],o||(o=s[a]=[]),-1===n(o,t)&&o.push([t,i])},off:function(e,t){var i,o,a,s=r(this);for(e=e.split(/\s+/);o=e.shift();)t?(i=s[o],a=n(i,t),-1!==a&&i.splice(a,1)):s[o]=[]},trigger:function(e,n){var i,o,a,s,u,c=r(this);if(i=c[e])for(var l=0;i.length>l;l++)o=i[l],a=o[0],s=o[1],"object"!=typeof n&&(n={detail:n}),u=new t(e,n),a.call(s,u)}};e.EventTarget=i}),e("rsvp/hash",["rsvp/defer","exports"],function(e,t){"use strict";function n(e){var t=0;for(var n in e)t++;return t}function r(e){var t={},r=i(),o=n(e);0===o&&r.resolve({});var a=function(e){return function(t){s(e,t)}},s=function(e,n){t[e]=n,0===--o&&r.resolve(t)},u=function(e){r.reject(e)};for(var c in e)e[c]&&"function"==typeof e[c].then?e[c].then(a(c),u):s(c,e[c]);return r.promise}var i=e.defer;t.hash=r}),e("rsvp/node",["rsvp/promise","rsvp/all","exports"],function(e,t,n){"use strict";function r(e,t){return function(n,r){n?t(n):arguments.length>2?e(Array.prototype.slice.call(arguments,1)):e(r)}}function i(e){return function(){var t,n,i=Array.prototype.slice.call(arguments),s=new o(function(e,r){t=e,n=r});return a(i).then(function(i){i.push(r(t,n));try{e.apply(this,i)}catch(o){n(o)}}),s}}var o=e.Promise,a=t.all;n.denodeify=i}),e("rsvp/promise",["rsvp/config","rsvp/events","exports"],function(e,t,n){"use strict";function r(e,t){t&&"function"==typeof t.then?t.then(function(t){r(e,t)},function(t){o(e,t)}):i(e,t)}function i(e,t){a.async(function(){e.trigger("promise:resolved",{detail:t}),e.isFulfilled=!0,e.fulfillmentValue=t})}function o(e,t){a.async(function(){e.trigger("promise:failed",{detail:t}),e.isRejected=!0,e.rejectedReason=t})}var a=e.config,s=t.EventTarget,u=function(e){var t=this,n=!1;if("function"!=typeof e)throw new TypeError("You must pass a resolver function as the sole argument to the promise constructor");if(!(t instanceof u))return new u(e);var i=function(e){n||(n=!0,r(t,e))},a=function(e){n||(n=!0,o(t,e))};this.on("promise:resolved",function(e){this.trigger("success",{detail:e.detail})},this),this.on("promise:failed",function(e){this.trigger("error",{detail:e.detail})},this),e(i,a)},c=function(e,t,n,i){var a,s,u,c,l="function"==typeof n;if(l)try{a=n(i.detail),u=!0}catch(h){c=!0,s=h}else a=i.detail,u=!0;a&&"function"==typeof a.then?a.then(function(e){r(t,e)},function(e){o(t,e)}):l&&u?r(t,a):c?o(t,s):"resolve"===e?r(t,a):"reject"===e&&o(t,a)};u.prototype={constructor:u,then:function(e,t){var n=new u(function(){});return this.isFulfilled&&a.async(function(){c("resolve",n,e,{detail:this.fulfillmentValue})},this),this.isRejected&&a.async(function(){c("reject",n,t,{detail:this.rejectedReason})},this),this.on("promise:resolved",function(t){c("resolve",n,e,t)}),this.on("promise:failed",function(e){c("reject",n,t,e)}),n}},s.mixin(u.prototype),n.Promise=u}),e("rsvp/resolve",["rsvp/promise","exports"],function(e,t){"use strict";function n(e){return"function"==typeof e||"object"==typeof e&&null!==e}function r(e){var t=new i(function(t,r){var i;try{n(e)?(i=e.then,"function"==typeof i?i.call(e,t,r):t(e)):t(e)}catch(o){r(o)}});return t}var i=e.Promise;t.resolve=r}),e("rsvp",["rsvp/events","rsvp/promise","rsvp/node","rsvp/all","rsvp/hash","rsvp/defer","rsvp/config","rsvp/resolve","exports"],function(e,t,n,r,i,o,a,s,u){"use strict";function c(e,t){g[e]=t}var l=e.EventTarget,h=t.Promise,f=n.denodeify,d=r.all,p=i.hash,v=o.defer,g=a.config,m=s.resolve;u.Promise=h,u.EventTarget=l,u.all=d,u.hash=p,u.defer=v,u.denodeify=f,u.configure=c,u.resolve=m}),window.RSVP=t("rsvp")}(),function(e,t,n){"use strict";function r(e,t){this.router=e,this.promise=t,this.data={},this.resolvedModels={},this.providedModels={},this.providedModelsArray=[],this.sequence=++r.currentSequence,this.params={}}function i(){this.recognizer=new t}function o(e,t){return new r(e,n.reject(t))}function a(e,t,n,r){var i,o,a=t.length,u={},c=e.currentHandlerInfos||[],h={},f=e.currentParams||{},d=e.activeTransition,p={};for(n=P.call(n),l(h,r),i=t.length-1;i>=0;i--){var v=t[i],g=v.handler,m=c[i],y=!1;if(m&&m.name===v.handler||(y=!0),v.isDynamic)if(o=s(n,g,d,!0,h))y=!0,u[g]=o;else{p[g]={};for(var w in v.params)if(v.params.hasOwnProperty(w)){var x=v.params[w];f[w]!==x&&(y=!0),p[g][w]=h[w]=x}}else if(v.hasOwnProperty("names"))if(n.length&&(y=!0),o=s(n,g,d,v.names[0],h))u[g]=o;else{var b=v.names;p[g]={};for(var A=0,E=b.length;E>A;++A){var R=b[A];p[g][R]=h[R]=h[R]||f[R]}}y&&(a=i)}if(n.length>0)throw Error("More context objects were passed than there are dynamic segments for the route: "+t[t.length-1].handler);return{matchPoint:a,providedModels:u,params:h,handlerParams:p}}function s(e,t,n,r,i){if(e.length&&r){var o=e.pop();if(!u(o))return o;i[r]=""+o}else if(n)return n.resolvedModels[t]||r&&n.providedModels[t]}function u(e){return"string"==typeof e||e instanceof String||!isNaN(e)}function c(e,t,n){var r,i,o,s,u,c=e.recognizer.handlersFor(t),h={},f=a(e,c,n).matchPoint;for(u=0;c.length>u;u++)i=c[u],o=e.getHandler(i.handler),s=i.names,s.length&&(r=u>=f?n.shift():o.context,l(h,z(o,r,s)));return h}function l(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function h(e,t){var n=e.recognizer.handlersFor(t[0]);return T(e,"Attempting transition to "+t[0]),w(e,n,P.call(t,1),e.currentParams)}function f(e,t){var n=e.recognizer.recognize(t);return e.currentHandlerInfos,T(e,"Attempting URL transition to "+t),n?w(e,n,[],{}):o(e,new i.UnrecognizedURLError(t))}function d(e,t){var n=e.router,r=g(n.currentHandlerInfos||[],t);n.targetHandlerInfos=t,v(r.exited,function(e){var t=e.handler;delete t.context,t.exit&&t.exit()});var i=r.unchanged.slice();n.currentHandlerInfos=i,v(r.updatedContext,function(t){p(e,i,t,!1)}),v(r.entered,function(t){p(e,i,t,!0)})}function p(e,t,n,r){var o=n.handler,a=n.context;try{r&&o.enter&&o.enter(),R(e),y(o,a),o.setup&&o.setup(a),R(e)}catch(s){throw s instanceof i.TransitionAborted||m(t.concat(n),!0,["error",s,e]),s}t.push(n)}function v(e,t){for(var n=0,r=e.length;r>n;n++)t(e[n])}function g(e,t){var n,r,i,o,a={updatedContext:[],exited:[],entered:[],unchanged:[]};for(i=0,o=t.length;o>i;i++){var s=e[i],u=t[i];s&&s.handler===u.handler||(n=!0),n?(a.entered.push(u),s&&a.exited.unshift(s)):r||s.context!==u.context?(r=!0,a.updatedContext.push(u)):a.unchanged.push(s)}for(i=t.length,o=e.length;o>i;i++)a.exited.unshift(e[i]);return a}function m(e,t,n){var r=n.shift();if(!e){if(t)return;throw Error("Could not trigger event '"+r+"'. There are no active handlers")}for(var i=!1,o=e.length-1;o>=0;o--){var a=e[o],s=a.handler;if(s.events&&s.events[r]){if(s.events[r].apply(s,n)!==!0)return;i=!0}}if(!i&&!t)throw Error("Nothing handled the event '"+r+"'.")}function y(e,t){e.context=t,e.contextDidChange&&e.contextDidChange()}function w(e,t,i,o,s){function u(){R(v);try{T(e,v.sequence,"Validation succeeded, finalizing transition;"),d&&d.length&&d.length===l.matchPoint||A(v,g),e.didTransition&&e.didTransition(g),T(e,v.sequence,"TRANSITION COMPLETE."),p.resolve(g[g.length-1].handler)}catch(t){p.reject(t)}v.isAborted||(e.activeTransition=null)}function c(e){p.reject(e)}var l=a(e,t,i,o),h=t[t.length-1].handler,f=!1,d=e.currentHandlerInfos;if(e.activeTransition){if(b(e.activeTransition,h,i))return e.activeTransition;e.activeTransition.abort(),f=!0}var p=n.defer(),v=new r(e,p.promise);v.targetName=h,v.providedModels=l.providedModels,v.providedModelsArray=i,v.params=l.params,v.data=s||{},e.activeTransition=v;var g=x(e,t);return f||m(d,!0,["willTransition",v]),T(e,v.sequence,"Beginning validation for transition to "+v.targetName),E(v,g,0,l.matchPoint,l.handlerParams).then(u,c),v}function x(e,t){for(var n=[],r=0,i=t.length;i>r;++r){var o=t[r],a=o.isDynamic||o.names&&o.names.length;n.push({isDynamic:!!a,name:o.handler,handler:e.getHandler(o.handler)})}return n}function b(e,t,n){if(e.targetName!==t)return!1;var r=e.providedModelsArray;if(r.length!==n.length)return!1;for(var i=0,o=r.length;o>i;++i)if(r[i]!==n[i])return!1;return!0}function A(e,t){for(var n=e.router,r=(e.sequence,t[t.length-1].name),i=[],o=e.providedModelsArray.slice(),a=t.length-1;a>=0;--a){var s=t[a];if(s.isDynamic){var l=o.pop();i.unshift(u(l)?""+l:s.context)}}var h=c(n,r,i);e.providedModelsArray=[],e.providedContexts={},n.currentParams=h;var f=e.urlMethod;if(f){var p=n.recognizer.generate(r,h);"replace"===f?n.replaceURL(p):n.updateURL(p)}d(e,t)}function E(e,t,o,a,s){function u(t){return e.isAborted?(T(e.router,e.sequence,"detected abort."),n.reject(new i.TransitionAborted)):t}function c(r){return r instanceof i.TransitionAborted?n.reject(r):(e.abort(),T(p,w,y+": handling error: "+r),m(t.slice(0,o+1),!0,["error",r,e]),g.error&&g.error(r,e),n.reject(r))}function l(){T(p,w,y+": calling beforeModel hook");var t=g.beforeModel&&g.beforeModel(e);return t instanceof r?null:t}function h(){T(p,w,y+": resolving model");var t=M(v,e,s[y],o>=a);return t instanceof r?null:t}function f(t){T(p,w,y+": calling afterModel hook"),e.resolvedModels[v.name]=t;var n=g.afterModel&&g.afterModel(t,e);return n instanceof r?null:n}function d(){return T(p,w,y+": validation succeeded, proceeding"),v.context=e.resolvedModels[v.name],E(e,t,o+1,a,s)}if(o===t.length)return n.resolve(e.resolvedModels);var p=e.router,v=t[o],g=v.handler,y=v.name,w=e.sequence;return a>o?(T(p,w,y+": using context from already-active handler"),e.resolvedModels[v.name]=e.providedModels[v.name]||v.handler.context,d()):n.resolve().then(u).then(l).then(u).then(h).then(u).then(f).then(u).then(d).then(null,c)}function R(e){if(e.isAborted)throw T(e.router,e.sequence,"detected abort."),new i.TransitionAborted}function M(e,t,n,r){var i=e.handler,o=e.name;if(!r&&i.hasOwnProperty("context"))return i.context;if(t.providedModels.hasOwnProperty(o)){var a=t.providedModels[o];return"function"==typeof a?a():a}return i.model&&i.model(n||{},t)}function T(e,t,n){e.log&&(3===arguments.length?e.log("Transition #"+t+": "+n):(n=t,e.log(n)))}function C(e,t){var n=t[0]||"/";return"/"===n.charAt(0)?f(e,n):h(e,t)}function z(e,t,n){var r={};if(u(t))return r[n[0]]=t,r;if(e.serialize)return e.serialize(t,n);if(1===n.length){var i=n[0];return r[i]=/_id$/.test(i)?t.id:t,r}}var P=Array.prototype.slice;r.currentSequence=0,r.prototype={targetName:null,urlMethod:"update",providedModels:null,resolvedModels:null,params:null,promise:null,data:null,then:function(e,t){return this.promise.then(e,t)},abort:function(){return this.isAborted?this:(T(this.router,this.sequence,this.targetName+": transition was aborted"),this.isAborted=!0,this.router.activeTransition=null,this)},retry:function(){this.abort();var e=this.router.recognizer.handlersFor(this.targetName),t=w(this.router,e,this.providedModelsArray,this.params,this.data);return t},method:function(e){return this.urlMethod=e,this}},i.UnrecognizedURLError=function(e){this.message=e||"UnrecognizedURLError",this.name="UnrecognizedURLError"},i.TransitionAborted=function(e){this.message=e||"TransitionAborted",this.name="TransitionAborted"},i.prototype={map:function(e){this.recognizer.delegate=this.delegate,this.recognizer.map(e,function(e,t){var n=t[t.length-1].handler,r=[t,{as:n}];e.add.apply(e,r)})},hasRoute:function(e){return this.recognizer.hasRoute(e)},reset:function(){v(this.currentHandlerInfos||[],function(e){var t=e.handler;t.exit&&t.exit()}),this.currentHandlerInfos=null,this.targetHandlerInfos=null},activeTransition:null,handleURL:function(e){var t=P.call(arguments);return"/"!==e.charAt(0)&&(t[0]="/"+e),C(this,t).method(null)},updateURL:function(){throw Error("updateURL is not implemented")},replaceURL:function(e){this.updateURL(e)},transitionTo:function(){return C(this,arguments)},replaceWith:function(){return C(this,arguments).method("replace")},paramsForHandler:function(e){return c(this,e,P.call(arguments,1))},generate:function(e){var t=c(this,e,P.call(arguments,1));return this.recognizer.generate(e,t)},isActive:function(e){var t,n,r=P.call(arguments,1),i=this.targetHandlerInfos,o=!1;if(!i)return!1;for(var a=this.recognizer.handlersFor(i[i.length-1].name),s=i.length-1;s>=0;s--)if(n=i[s],n.name===e&&(o=!0),o){if(0===r.length)break;if(n.isDynamic)if(t=r.pop(),u(t)){var c=a[s],l=c.names[0];if(""+t!==this.currentParams[l])return!1}else if(n.context!==t)return!1}return 0===r.length&&o},trigger:function(){var e=P.call(arguments);m(this.currentHandlerInfos,!1,e)},log:null},e.Router=i}(window,window.RouteRecognizer,window.RSVP),function(e,t){"use strict";var n=function(n){var r,i,o;return r=function(e,t){var n,i={};if("function"==typeof t)return function(){return t.apply(e,arguments)};for(n in t)i[n]=r(e,t[n]);return i},i=function(e){return e},o=function(e){return t.createElement&&t.createElement(e)},function(t){var a,s,u,c,l,h,f,d,p,v=t||"/";return c=new Router,h=function(e,t,r){return"boolean"==typeof t&&(r=t,t=n),"/"!==(e+"").charAt(0)&&(e=a.context.url(e,t||{})),r=t&&t.update||r,r=null==r?!0:r,[e,t||{},r]},d=function(e){return function(t){return t&&t.preventDefault&&t.preventDefault(),a.context.go(e),!1}},p=function(e){e.state&&e.state.to&&a.context.go(e.state.to,!1)},l=function(e,t){var n,r,i=o("a");f=h(e,t),r=f.shift(),t=f.shift(),i.innerHTML=e,i.href=r,i.click&&"function"==typeof i.click?i.addEventListener?i.addEventListener("click",d(r),!1):i.attachEvent?i.attachEvent("onclick",d(r)):i.onclick=d(r):i.click=d(r);for(n in t)i[n]=t[n];return i},s=function(e){var t,n,o,s={};n=this,c.map(function(t){s=e.apply(n,[t])||{}});for(t in s)o=s[t],this[t]="function"==typeof o?{setup:o}:o,"model"in this[t]||(this[t].model=i),c.handlers[t]=r(a.context,this[t])},u=function(e){var t,n,i={};for(t in e){if(isNaN(-t)?n=t:(n=e[t]+"",n=/function\s(.+?)\b/.exec(n)[1]||null),"function"!=typeof e[t])throw Error("<"+(n||e[t])+"> is not a module!");if(t=new e[t](a),!t.initialize_module||"function"!=typeof t.initialize_module)throw Error("<"+n+"#initialize_module> is missing!");a.context.send(t.initialize_module,{draw:r(t,s)}),i[n]=t}return i},a={router:c,modules:{},context:{globals:{},helpers:{},send:function(e,t){var r,i=0;for(e="object"==typeof e&&e.length?e:[e],t="object"==typeof t&&t.length===n?t:{},r=e.length;r>i;i+=1)e[i].apply(a.context,[t])},link:function(e,t,n){return l(e,t,n)},url:function(e,t){try{return c.recognizer.generate(e,t)}catch(n){throw Error("<"+e+"> route not found or missing params!")}},go:function(e,t,n){f=h(e,t,n),c.redirectURL(f.shift(),f.pop())}},run:function(){if(!this.modules||0===this.modules.length)throw Error("<App#load> cannot run without modules!");return this.context.go(v,!1)},load:function(e){var t,n;if("object"!=typeof e&&(e=e&&[e]),!e||0===e.length)throw Error("<App#load> require some modules!");e=u(e);for(t in e)this.modules[t]||"object"!=typeof e[t]||(n=e[t],this.modules[t]=n);return this}},c.handlers={},c.updateURL=function(t){e.history&&e.history.pushState&&e.history.pushState({to:t},null,t)},c.getHandler=function(e){return c.handlers[e]||{}},c.redirectURL=function(e,t){!1!==t?(c.updateURL(e),c.handleURL(e)):c.handleURL(e)},e.addEventListener?e.addEventListener("popstate",p):e.onpopstate=p,a}}();n.modules=function(){var e,t={};for(e in n)e.charAt(0)===e.charAt(0).toUpperCase()&&(t[e]=n[e]);return t},"undefined"!=typeof module&&module.exports?module.exports=n:"function"==typeof define&&define.amd?define(function(){return n}):e.App=n}(window,document);