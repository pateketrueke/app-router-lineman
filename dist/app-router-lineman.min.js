/*! app-router-lineman - v0.0.1 - 2013-07-12 */
(function(t){"use strict";t.App=function(t){return function(r){var n,e,o=["Router","RouteRecognizer","RSVP"],i=r===t||"function"!=typeof r;document.location.pathname||"/",document.body||null;try{r=i?new Router:r?r():null}catch(u){throw Error("<"+o.join(",")+"> are missing classes?")}finally{if(!r)throw Error("Missing a valid router!")}return e=function(t){var n,e,o,i={};r.map(function(r){i=t(r)||{}});for(n in i)o=i[n],this[n]="function"==typeof o?{setup:o}:o,this[n].events=null!==(e=this[n].events||null)?e:{},r.handlers[n]=this[n]},loader=function(t){for(var r,n,o=0,i=t.length;i>o;o+=1){if("function"!=typeof t[o])throw Error("<"+t[o]+"> is not a module!");if(r=new t[o],!r.initialize_module||"function"!=typeof r.initialize_module)throw n=""+t[o],n=/\s(.+?)\b/.exec(n)[1],Error("<"+n+"#initialize_method> is missing!");r.initialize_module({draw:e}),t[o]={module:r,klass:n}}return t},n={modules:[],history:[],router:r,context:context,run:function(t,n){if(!this.modules||0===this.modules.length)throw Error("<App#load> cannot run without modules!");if(n=n&&""+n,"string"!=typeof n||0!==n.indexOf("/"))throw Error("<"+n+"> missing root slash!");return r.handleURL(n),this},load:function(t){if(!t||0===t.length)throw Error("<App#load> require some modules!");return this.modules=loader(t),this},url:function(t,n){try{return r.recognizer.generate(t,n)}catch(e){throw Error("<"+t+"> route not found or missing params!")}},"goto":function(t){return r.redirect(t,!1)},trigger:function(){return r.trigger.apply(r,arguments)},redirect:function(){return r.redirect.apply(r,arguments)}},i&&(r.handlers={},r.updateURL=function(t){return history.pushState({},"Untitled",t)},r.getHandler=function(t){return r.handlers[t]||{}},r.redirect=function(t,e){try{r.handleURL(t)}catch(o){throw Error("<"+t+"> unknown route!")}return!1!==e&&(n.history.push(t),r.updateURL(t)),r}),n}}()})(this);